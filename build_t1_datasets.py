from pyscf import gto
from generate_t1_df import generate_t1_df
import pandas as pd
from datetime import datetime


training_molecules = [
    """
    H	0.0000	0.0000	0.0000
    H	0.0000	0.0000	0.7414
    """,
    """
    H  0.0000  0.0000  0.0000
    H  0.0000  0.0000  0.8155
    """,
    """
    H  0.0000  0.0000  0.0000
    H  0.0000  0.0000  0.6673
    """,
    """
    O	0.0000	0.0000	0.1173
    H	0.0000	0.7572	-0.4692
    H	0.0000	-0.7572	-0.4692
    """,
    """
    O   0.0000  0.0000  0.1173
    H   0.0000  0.8329  -0.5279
    H   0.0000  -0.7572 -0.4692
    """,
    """
    O   0.0000  0.0000  0.1173
    H   0.0000  0.6815  -0.4106
    H   0.0000  -0.7572 -0.4692
    """,
    """
    O   0.0000  0.0000  0.1173
    H   0.0000  0.7572  -0.4692
    H   0.0000  -0.8510 -0.3222
    """,
    """
    O   0.0000  0.0000  0.1173
    H   0.0000  0.7572  -0.4692
    H   0.0000  -0.6383 -0.5968
    """
    """
    C	0.0000	0.0000	0.0000
    H	0.6276	0.6276	0.6276
    H	0.6276	-0.6276	-0.6276
    H	-0.6276	0.6276	-0.6276
    H	-0.6276	-0.6276	0.6276
    """,
    """
    C   0.0000  0.0000  0.0000
    H   0.5648  0.5648  0.5648
    H   0.6276  -0.6276 -0.6276
    H   -0.6276 0.6276  -0.6276
    H   -0.6276 -0.6276 0.6276
    """,
    """
    C   0.0000  0.0000  0.0000
    H  0.6904  0.6904  0.6904
    H   0.6276  -0.6276 -0.6276
    H   -0.6276 0.6276  -0.6276
    H   -0.6276 -0.6276 0.6276
    """,
    """
    C   0.0000  0.0000  0.0000
    H   0.6276  0.6276  0.6276
    H   0.7847  -0.5319 -0.5319
    H   -0.6276 0.6276  -0.6276
    H   -0.6276 -0.6276 0.6276
    """,
    """
    C	0.0000	0.0000	0.6695
    C	0.0000	0.0000	-0.6695
    H	0.0000	0.9289	1.2321
    H	0.0000	-0.9289	1.2321
    H	0.0000	0.9289	-1.2321
    H	0.0000	-0.9289	-1.2321
    """,
    """
    C   0.0000  0.0000  0.6695
    C   0.0000  0.0000  -0.6695
    H   0.0000  0.7947  1.4096
    H   0.0000  -0.9289 1.2321
    H   0.0000  0.9289  -1.2321
    H   0.0000  -0.9289 -1.2321
    """,
    """
    C   0.0000  0.0000  0.6695
    C   0.0000  0.0000  -0.6695
    H   0.0000  1.0241  1.0310
    H   0.0000  -0.9289 1.2321
    H   0.0000  0.9289  -1.2321
    H   0.0000  -0.9289 -1.2321
    """,
    """
    C   0.0000  0.0000  0.6695
    C   0.0000  0.0000  -0.6695
    H   0.0000  1.0263  1.0245
    H   0.0000  -0.9289 1.2321
    H   0.0000  0.9289  -1.2321
    H   0.0000  -0.9289 -1.2321
    """,
    """
    C   0.0000  0.0000  0.6695
    C   0.0000  0.0000  -0.6695
    H   0.0000  0.7901  1.4146
    H   0.0000  -0.9289 1.2321
    H   0.0000  0.9289  -1.2321
    H   0.0000  -0.9289 -1.2321
    """,
    """
    C   0.0000  0.0000  0.6695
    C   0.0000  0.0000  -0.8034
    H   0.0000  0.9289  1.2321
    H   0.0000  -0.9289 1.2321
    H   0.0000  0.9289  -1.3660
    H   0.0000  -0.9289 -1.3660
    """,
    """
    C   0.0000  0.0000  0.6695
    C   0.0000  0.0000  -0.5356
    H   0.0000  0.9289  1.2321
    H   0.0000  -0.9289 1.2321
    H   0.0000  0.9289  -1.0982
    H   0.0000  -0.9289 -1.0982
    """,
    """
    C   0.0000  0.0000  0.6695
    C   0.0000  0.0000  -0.6695
    H   0.0000  1.0218  1.2884
    H   0.0000  -0.9289 1.2321
    H   0.0000  0.9289  -1.2321
    H   0.0000  -0.9289 -1.2321
    """,
    """
    C   0.0000  0.0000  0.6695
    C   0.0000  0.0000  -0.6695
    H   0.0000  0.8360  1.1758
    H   0.0000  -0.9289 1.2321
    H   0.0000  0.9289  -1.2321
    H   0.0000  -0.9289 -1.2321
    """,
    """
    C	0.0000	0.0000	0.7680
    C	0.0000	0.0000	-0.7680
    H	-1.0192	0.0000	1.1573
    H	0.5096	0.8826	1.1573
    H	0.5096	-0.8826	1.1573
    H	1.0192	0.0000	-1.1573
    H	-0.5096	-0.8826	-1.1573
    H	-0.5096	0.8826	-1.1573
    """,
    """
    C   0.0000  0.0000  0.7680
    C   0.0000  0.0000  -0.9216
    H   -1.0192 0.0000  1.1573
    H   0.5096  0.8826  1.1573
    H   0.5096  -0.8826 1.1573
    H   1.0192  0.0000  -1.3109
    H   -0.5096 -0.8826 -1.3109
    H   -0.5096 0.8826  -1.3109
    """,
    """
    C   0.0000  0.0000  0.7680
    C   0.0000  0.0000  -0.6144
    H   -1.0192 0.0000  1.1573
    H   0.5096  0.8826  1.1573
    H   0.5096  -0.8826 1.1573
    H   1.0192  0.0000  -1.0037
    H   -0.5096 -0.8826 -1.0037
    H   -0.5096 0.8826  -1.0037
    """,
    """
    C   0.0000  0.0000  0.7680
    C   0.0000  0.0000  -0.7680
    H   -1.1211 0.0000  1.1962
    H   0.5096  0.8826  1.1573
    H   0.5096  -0.8826 1.1573
    H   1.0192  0.0000  -1.1573
    H   -0.5096 -0.8826 -1.1573
    H   -0.5096 0.8826  -1.1573
    """,
    """
    C   0.0000  0.0000  0.7680
    C   0.0000  0.0000  -0.7680
    H   -0.9173 0.0000  1.1184
    H   0.5096  0.8826  1.1573
    H   0.5096  -0.8826 1.1573
    H   1.0192  0.0000  -1.1573
    H   -0.5096 -0.8826 -1.1573
    H   -0.5096 0.8826  -1.1573
    """,
    """
    C   0.0000  0.0000  0.7680
    C   0.0000  0.0000  -0.7680
    H   -0.9253 0.0000  1.3461
    H   0.5096  0.8826  1.1573
    H   0.5096  -0.8826 1.1573
    H   1.0192  0.0000  -1.1573
    H   -0.5096 -0.8826 -1.1573
    H   -0.5096 0.8826  -1.1573
    """,
    """
    C   0.0000  0.0000  0.7680
    C   0.0000  0.0000  -0.7680
    H   -1.0751 0.0000  0.9540
    H   0.5096  0.8826  1.1573
    H   0.5096  -0.8826 1.1573
    H   1.0192  0.0000  -1.1573
    H   -0.5096 -0.8826 -1.1573
    H   -0.5096 0.8826  -1.1573
    """,
    """
    C   0.0000  0.0000  0.7680
    C   0.0000  0.0000  -0.7680
    H   -1.0192 0.0000  1.1573
    H   0.3308  0.9207  1.2508
    H   0.5096  -0.8826 1.1573
    H   1.0192  0.0000  -1.1573
    H   -0.5096 -0.8826 -1.1573
    H   -0.5096 0.8826  -1.1573
    """,
    """
    C   0.0000  0.0000  0.7680
    C   0.0000  0.0000  -0.7680
    H   -1.0192 0.0000  1.1573
    H   0.6703  0.8132  1.0500
    H   0.5096  -0.8826 1.1573
    H   1.0192  0.0000  -1.1573
    H   -0.5096 -0.8826 -1.1573
    H   -0.5096 0.8826  -1.1573
    """
    """
    N	0.0000	0.0000	0.0000
    H	0.0000	-0.9377	-0.3816
    H	0.8121	0.4689	-0.3816
    H	-0.8121	0.4689	-0.3816
    """,
    """
    N   0.0000  0.0000  0.0000
    H   0.0000  -0.8439 -0.3434
    H   0.8121  0.4689  -0.3816
    H   -0.8121 0.4689  -0.3816
    """,
    """
    N   0.0000  0.0000  0.0000  
    H   0.0000  -1.0315 -0.4198
    H   0.8121  0.4689  -0.3816
    H   -0.8121 0.4689  -0.3816
    """,
    """
    N   0.0000  0.0000  0.0000
    H   0.0000  -0.9377 -0.3816
    H   0.7530  0.6160  -0.2801
    H   -0.8121 0.4689  -0.3816
    """,
    """
    N   0.0000  0.0000  0.0000
    H   0.0000  -0.9377 -0.3816
    H   0.8431  0.3056  -0.4699
    H   -0.8121 0.4689  -0.3816
    """,
    """
    C	0.0000	0.0000	0.0000
    O	0.0000	0.0000	1.1621
    O	0.0000	0.0000	-1.1621
    """,
    """
    C  0.0000  0.0000  0.0000
    O  0.0000  0.0000  1.0459
    O  0.0000  0.0000  -1.1621
    """,
    """
    C  0.0000  0.0000  0.0000
    O  0.0000  0.0000  1.2783
    O  0.0000  0.0000  -1.1621
    """,
    """
    C  0.0000  0.0000  0.0000
    O  0.3582  0.0000  1.1055
    O  0.0010  0.0000  -1.1621
    """,
    """
    C	0.0000	0.0000	0.0000
    O	0.0000	0.0000	1.1282
    """,
    """
    C  0.0000  0.0000  0.0000
    O  0.0000  0.0000  1.2410
    """,
    """
    C  0.0000  0.0000  0.0000
    O  0.0000  0.0000  1.0154
    """,
    """
    F	0.0000	0.0000	0.0000
    H	0.0000	0.0000	0.9168
    """,
    """
    F  0.0000  0.0000  0.0000
    H  0.0000  0.0000  0.8251
    """,
    """
    F  0.0000  0.0000  0.0000
    H  0.0000  0.0000  1.0085
    """,
    """
    N	0.0000	0.6260	0.0000
    N	0.0000	-0.6260	0.0000
    H	0.9867	0.9145	0.0000
    H	-0.9867	-0.9145	0.0000
    """,
    """
    N  0.0000  0.6260  0.0000
    N  0.0000  -0.5008 0.0000
    H  0.9867  0.9145  0.0000
    H  -0.9867 -0.7893 0.0000
    """,
    """
    N  0.0000  0.6260  0.0000
    N  0.0000  -0.7512 0.0000
    H  0.9867  0.9145  0.0000
    H  -0.9867 -1.0397 0.0000
    """,
    """
    N  0.0000  0.6260  0.0000
    N  0.0000  -0.6260 0.0000
    H  0.8880  0.8856  0.0000
    H  -0.9867 -0.9145 0.0000
    """,
    """
    N  0.0000  0.6260  0.0000
    N  0.0000  -0.6260 0.0000
    H  1.0854  0.9434  0.0000
    H  -0.9867 -0.9145 0.0000
    """,
    """
    N  0.0000  0.6260  0.0000
    N  0.0000  -0.6260 0.0000
    H  1.0230  0.7275  0.0000
    H  -0.9867 -0.9145 0.0000
    """,
    """
    N  0.0000  0.6260  0.0000
    N  0.0000  -0.6260 0.0000
    H  0.9166  1.0916  0.0000
    H  -0.9867 -0.9145 0.0000
    """,
    """
    N	0.0000	0.6319	-0.1237	
    N	0.0000	-0.6319	-0.1237	 
    H	0.0000	1.0214	0.8661	
    H	0.0000	-1.0214	0.8661
    """,
    """
    N  0.0000  0.6319  -0.1237
    N  0.0000  -0.7583 -0.1237
    H  0.0000  1.0214  0.8661
    H  0.0000  -1.1478 0.8661
    """,
    """
    N  0.0000  0.6319  -0.1237
    N  0.0000  -0.5055 -0.1237
    H  0.0000  1.0214  0.8661
    H  0.0000  -0.8950 0.8661
    """,
    """
    N  0.0000  0.6319  -0.1237
    N  0.0000  -0.6319 -0.1237
    H  0.0000  0.9825  0.7671
    H  0.0000  -1.0214 0.8661
    """,
    """
    N  0.0000  0.6319  -0.1237
    N  0.0000  -0.6319 -0.1237
    H  0.0000  1.0604  0.9651
    H  0.0000  -1.0214 0.8661
    """,
    """
    N  0.0000  0.6319  -0.1237
    N  0.0000  -0.6319 -0.1237
    H  0.0000  1.2054  0.7721
    H  0.0000  -1.0214 0.8661
    """,
    """
    N  0.0000  0.6319  -0.1237
    N  0.0000  -0.6319 -0.1237
    H  0.0000  0.8227  0.9227
    H  0.0000  -1.0214 0.8661
    """,
    """
    C	0.0000	0.0000	0.0000
    H	0.0000	0.0000	1.0640
    N	0.0000	0.0000	-1.1560
    """,
    """
    C  0.0000  0.0000  0.0000
    H  0.0000  0.0000  1.1704
    N  0.0000  0.0000  -1.1560
    """,
    """
    C  0.0000  0.0000  0.0000
    H  0.0000  0.0000  0.9576
    N  0.0000  0.0000  -1.1560
    """,
    """
    C  0.0000  0.0000  0.0000
    H  0.0000  0.0000  1.0640
    N  0.0000  0.0000  -1.0404
    """,
    """
    C  0.0000  0.0000  0.0000
    H  0.0000  0.0000  1.0640
    N  0.0000  0.0000  -1.2716
    """
    """
    C  0.0000  0.0000  0.0000
    H  0.3279  0.0000  1.0122
    N  0.0010  0.0000  -1.1560
    """,
    """
    C	0.0000	0.0000	-0.7405
    N	0.0000	0.0000	0.4321
    H	0.0000	0.0000	1.4183
    """,
    """
    C  0.0000  0.0000  -0.7405
    N  0.0000  0.0000  0.3148
    H  0.0000  0.0000  1.3010
    """,
    """
    C  0.0000  0.0000  -0.7405
    N  0.0000  0.0000  0.5494
    H  0.0000  0.0000  1.5356
    """,
    """
    C  0.0000  0.0000  -0.7405
    N  0.0000  0.0000  0.4321
    H  0.0000  0.0000  1.5169
    """,
    """
    C  0.0000  0.0000  -0.7405
    N  0.0000  0.0000  0.4321
    H  0.0000  0.0000  1.3197
    """,
    """
    C  0.3612  0.0000  -0.6835
    N  0.0000  0.0000  0.4321
    H  0.0010  0.0000  1.4183
    """,
    """
    O	0.0000	0.7375	-0.0528
    O	0.0000	-0.7375	-0.0528
    H	0.8190	0.8170	0.4220
    H	-0.8190	-0.8170	0.4220
    """,
    """
    O  0.0000  0.7375  -0.0528
    O  0.0000  -0.8850 -0.0528
    H  0.8190  0.8170  0.4220
    H  -0.8190 -0.9645 0.4220
    """,
    """
    O  0.0000  0.7375  -0.0528
    O  0.0000  -0.5900 -0.0528
    H  0.8190  0.8170  0.4220
    H  -0.8190 -0.6695 0.4220
    """,
    """
    O  0.0000  0.7375  -0.0528
    O  0.0000  -0.7375 -0.0528
    H  0.7371  0.8090  0.3745
    H  -0.8190 -0.8170 0.4220
    """,
    """
    O  0.0000  0.7375  -0.0528
    O  0.0000  -0.7375 -0.0528
    H  0.9009  0.8249  0.4695
    H  -0.8190 -0.8170 0.4220
    """,
    """
    O  0.0000  0.7375  -0.0528
    O  0.0000  -0.7375 -0.0528
    H  0.8191  0.6600  0.4221
    H  -0.8190 -0.8170 0.4220
    """,
    """
    O  0.0000  0.7375  -0.0528
    O  0.0000  -0.7375 -0.0528
    H  0.7965  0.9718  0.4089
    H  -0.8190 -0.8170 0.4220
    """,
    """
    F	0.0000	0.0000	0.0000
    F	0.0000	0.0000	1.4119
    """,
    """
    F	0.0000	0.0000	0.0000
    F	0.0000	0.0000	1.5531
    """,
    """
    F	0.0000	0.0000	0.0000
    F	0.0000	0.0000	1.2707
    """,
    """
    N	0.0000	0.0000	0.5488
    N	0.0000	0.0000	-0.5488
    """,
    """
    N	0.0000	0.0000	0.5488
    N	0.0000	0.0000	-0.4390
    """,
    """
    N	0.0000	0.0000	0.5488
    N	0.0000	0.0000	-0.6586
    """,
    """
    O	0.0529	0.7143	0.0000
    H	-0.8995	0.8346	0.0000
    F	0.0529	-0.7277	0.0000
    """,
    """
    O  0.0529  0.7143  0.0000
    H  -0.9947 0.8466  0.0000
    F  0.0529  -0.7277 0.0000
    """,
    """
    O  0.0529  0.7143  0.0000
    H  -0.8043 0.8226  0.0000
    F  0.0529  -0.7277 0.0000
    """,
    """
    O  0.0529  0.7143  0.0000
    H  -0.8995 0.8346  0.0000
    F  0.0529  -0.5835 0.0000
    """,
    """
    O  0.0529  0.7143  0.0000
    H  -0.8995 0.8346  0.0000
    F  0.0529  -0.8719 0.0000
    """,
    """
    O  0.0529  0.7143  0.0000
    H  -0.8995 0.8346  0.0000
    F  -0.1906 -0.7070 0.0000
    """,
    """
    O  0.0529  0.7143  0.0000
    H  -0.8995 0.8346  0.0000
    F  0.2964  -0.7070 0.0000
    """,
    """
    O	0.0000	0.0000	0.0000
    O	0.0000	1.0885	0.6697
    O	0.0000	-1.0885	0.6697
    """,
    """
    O  0.0000  0.0000  0.0000
    O  0.0000  1.1974  0.7367
    O  0.0000  -1.0885 0.6697
    """,
    """
    O  0.0000  0.0000  0.0000
    O  0.0000  0.9796  0.6027
    O  0.0000  -1.0885 0.6697
    """,
    """
    O  0.0000  0.0000  0.0000
    O  0.0000  1.0885  0.6697
    O  0.0000  -1.2015 0.4355
    """,
    """
    O  0.0000  0.0000  0.0000
    O  0.0000  1.0885  0.6697
    O  0.0000  -0.9304 0.8762
    """
]

training_ions = [
    """
    O	0.0000	0.0000	0.0000
    H	0.0000	0.0000	0.9640
    """,
    """
    O   0.0000  0.0000  0.0000
    H   0.0000  0.0000  0.8676
    """,
    """
    O   0.0000  0.0000  0.0000
    H   0.0000  0.0000  1.0604
    """,
    """
    N	0.0000	0.0000	0.0000	 	
    H	0.6896	0.6896	0.6896	 	
    H	-0.6896	-0.6896	0.6896	 	
    H	-0.6896	0.6896	-0.6896	 	
    H	0.6896	-0.6896	-0.6896
    """,
    """
    N   0.0000  0.0000  0.0000
    H   0.7586  0.7586  0.7586
    H   -0.6896 -0.6896 0.6896
    H   -0.6896 0.6896  -0.6896
    H   0.6896  -0.6896 -0.6896
    """,
    """
    N   0.0000  0.0000  0.0000
    H   0.6206  0.6206  0.6206
    H   -0.6896 -0.6896 0.6896
    H   -0.6896 0.6896  -0.6896
    H   0.6896  -0.6896 -0.6896
    """,
    """
    N   0.0000  0.0000  0.0000
    H   0.6896  0.6896  0.6896
    H   -0.5845 -0.5845 0.8623
    H   -0.6896 0.6896  -0.6896
    H   0.6896  -0.6896 -0.6896
    """,
    """
    N   0.0000  0.0000  0.0000
    H   0.6896  0.6896  0.6896
    H   -0.7697 -0.7697 0.4918
    H   -0.6896 0.6896  -0.6896
    H   0.6896  -0.6896 -0.6896
    """
]

testing_molecules = [
    """
    O	0.0000	0.0000	1.2050
    C	0.0000	0.0000	0.0000
    H	0.0000	0.9429	-0.5876
    H	0.0000	-0.9429	-0.5876
    """,
    """
    O   0.0000  0.0000  1.2050
    C   0.0000  0.0000  0.1205
    H   0.0000  0.9429  -0.4671
    H   0.0000  -0.9429 -0.4671
    """,
    """
    O   0.0000  0.0000  1.2050
    C   0.0000  0.0000  -0.1205
    H   0.0000  0.9429  -0.7081
    H   0.0000  -0.9429 -0.7081
    """,
    """
    O   0.0000  0.0000  1.2050
    C   0.0000  0.0000  0.0000
    H   0.0000  0.8486  -0.5288
    H   0.0000  -0.9429 -0.5876
    """,
    """
    O   0.0000  0.0000  1.2050
    C   0.0000  0.0000  0.0000
    H   0.0000  1.0372  -0.6464
    H   0.0000  -0.9429 -0.5876
    """,
    """
    O   0.0000  -0.2545 1.1778
    C   0.0000  0.0000  0.0000
    H   0.0000  0.9429  -0.5876
    H   0.0000  -0.9429 -0.5876
    """,
    """
    O   0.0000  0.2545  1.1778
    C   0.0000  0.0000  0.0000
    H   0.0000  0.9429  -0.5876
    H   0.0000  -0.9429 -0.5876
    """,
    """
    O   0.0000  0.0000  1.2050
    C   0.0000  0.0000  0.0000
    H   0.0000  0.9429  -0.5876
    H   0.0000  -1.0419 -0.3857
    """,
    """
    O   0.0000  0.0000  1.2050
    C   0.0000  0.0000  0.0000
    H   0.0000  0.9429  -0.5876
    H   0.0000  -0.8053 -0.7654 
    """,
    """
    C	1.1879	-0.3829	0.0000
    C	0.0000	0.5526	0.0000
    O	-1.1867	-0.2472	0.0000
    H	-1.9237	0.3850	0.0000
    H	2.0985	0.2306	0.0000
    H	1.1184	-1.0093	0.8869
    H	1.1184	-1.0093	-0.8869
    H	-0.0227	1.1812	0.8852
    H	-0.0227	1.1812	-0.8852
    """,
    """
    C   1.0692  -0.4629 0.0000
    C   -0.1187 0.4726  0.0000
    O   -1.1867 -0.2472 0.0000
    H   -1.9237 0.3850  0.0000
    H   1.9798  0.1506  0.0000
    H   0.9997  -1.0893 0.8869
    H   0.9997  -1.0893 -0.8869
    H   -0.1414 1.1012  0.8852
    H   -0.1414 1.1012  -0.8852
    """,
    """
    C   1.3066  -0.3029 0.0000
    C   0.1187  0.6326  0.0000
    O   -1.1867 -0.2472 0.0000
    H   -1.9237 0.3850  0.0000
    H   2.2172  0.3106  0.0000
    H   1.2371  -0.9293 0.8869
    H   1.2371  -0.9293 -0.8869
    H   0.0960  1.2612  0.8852
    H   0.0960  1.2612  -0.8852
    """,
    """
    C   1.1879  -0.3829 0.0000
    C   0.0000  0.5526  0.0000
    O   -1.1867 -0.2472 0.0000
    H   -1.8500 0.3218  0.0000
    H   2.0985  0.2306  0.0000
    H   1.1184  -1.0093 0.8869
    H   1.1184  -1.0093 -0.8869
    H   -0.0227 1.1812  0.8852
    H   -0.0227 1.1812  -0.8852
    """,
    """
    C   1.1879  -0.3829 0.0000
    C   0.0000  0.5526  0.0000
    O   -1.1867 -0.2472 0.0000
    H   -1.9974 0.4482  0.0000
    H   2.0985  0.2306  0.0000
    H   1.1184  -1.0093 0.8869
    H   1.1184  -1.0093 -0.8869
    H   -0.0227 1.1812  0.8852
    H   -0.0227 1.1812  -0.8852
    """,
    """
    C   1.0691  -0.2894 0.0000
    C   0.0000  0.5526  0.0000
    O   -1.1867 -0.2472 0.0000
    H   -1.9237 0.3850  0.0000
    H   1.9797  0.3241  0.0000
    H   0.9996  -0.9158 0.8869
    H   0.9996  -0.9158 -0.8869
    H   -0.0227 1.1812  0.8852
    H   -0.0227 1.1812  -0.8852
    """,
    """
    C   1.3067  -0.4765 0.0000
    C   0.0000  0.5526  0.0000
    O   -1.1867 -0.2472 0.0000
    H   -1.9237 0.3850  0.0000
    H   2.2173  0.1370  0.0000
    H   1.2372  -1.1029 0.8869
    H   1.2372  -1.1029 -0.8869
    H   -0.0227 1.1812  0.8852
    H   -0.0227 1.1812  -0.8852
    """,
    """
    C	0.0583	0.7129	0.0000	 	
    N	0.0583	-0.7726	0.0000	 	
    H	-0.9425	1.1529	0.0000	 	
    H	0.5877	1.0695	0.8821	 	
    H	0.5877	1.0695	-0.8821	 	
    H	-0.4953	-1.0804	-0.8165	 	
    H	-0.4953	-1.0804	0.8165
    """,
    """
    H	0.0000	-0.9718	0.9211
    N	0.0000	0.0648	0.5834
    O	0.0000	0.0648	-0.6256
    """,
    """
    H   0.0000  -0.9718 0.9211
    N   0.0000  0.1685  0.5496
    O   0.0000  0.1685  -0.6594
    """,
    """
    H   0.0000  -0.9718 0.9211
    N   0.0000  -0.0389 0.6172
    O   0.0000  -0.0389 -0.5918
    """,
    """
    H   0.0000  -0.9718 0.9211
    N   0.0000  0.0648  0.5834
    O   0.0000  0.0648  -0.5047
    """,
    """
    H   0.0000  -0.9718 0.9211
    N   0.0000  0.0648  0.5834
    O   0.0000  0.0648  -0.7465
    """,
    """
    H   0.0000  -1.0167 0.7208
    N   0.0000  0.0648  0.5834
    O   0.0000  0.0648  -0.6256
    """,
    """
    H   0.0000  -0.8901 1.1094
    N   0.0000  0.0648  0.5834
    O   0.0000  0.0648  -0.6256
    """
]

testing_ions = [
    """
    C	0.0000	0.0000	0.0000
    N	0.0000	0.0000	1.1770
    """,
    """
    C	0.0000	0.0000	0.0000
    N	0.0000	0.0000	1.9470
    """,
    """
    C	0.0000	0.0000	0.0000
    N	0.0000	0.0000	1.5930
    """,
    """
    O	0.0000	0.0000	0.0684	
    H	0.0000	0.9581	-0.1825	 
    H	0.8298	-0.4791	-0.1825	
    H	-0.8298	-0.4791	-0.1825
    """,
    """
    O   0.0000  -0.0958 0.0935
    H   0.0000  0.9581  -0.1825
    H   0.8298  -0.5749 -0.1574
    H   -0.8298 -0.5749 -0.1574
    """,
    """
    O   0.0000  0.0958  0.0433
    H   0.0000  0.9581  -0.1825
    H   0.8298  -0.3833 -0.2076
    H   -0.8298 -0.3833 -0.2076
    """
    """
    O   0.0000  0.0000  0.0684
    H   -0.1790 0.9592  -0.1016
    H   0.8298  -0.4791 -0.1825
    H   -0.8298 -0.4791 -0.1825
    """,
    """
    O   0.0000  0.0000  0.0684
    H   0.1790  0.9194  -0.2535
    H   0.8298  -0.4791 -0.1825
    H   -0.8298 -0.4791 -0.1825
    """,
    """
    O   0.0000  0.0000  0.0684
    H   -0.1790 0.9592  -0.1016
    H   0.8298  -0.4791 -0.1825
    H   -0.8298 -0.4791 -0.1825
    """
]


def build_mol(geom: str, *, charge: int = 0, spin: int | None = None, basis: str = "sto-3g", unit: str = "Angstrom") -> gto.Mole:

    mol = gto.Mole()
    mol.atom = geom
    mol.unit = unit
    mol.basiss = basis
    mol.charge = charge
    if spin is not None:
        mol.spin = spin
    mol.build()
    return mol

def dfs_from_geoms(geoms: list[str], *, 
                   charges: list[int]| None = None,
                   spins: list[int] | None = None,
                   basis: str = 'sto-3g',
                   unit: str = "Angstrom") -> pd.DataFrame:
    
    dfs = []
    for i, geom in enumerate(geoms):
        q = 0 if charges is None else charges[i]
        s = None if spins is None else spins[i]
        mol = build_mol(geom, charge = q, spin = s, basis = basis, unit = unit)
        df = generate_t1_df(mol)
        dfs.append(df)
    
    return pd.concat(dfs, ignore_index = True)


training_ion_charges = [-1, +1]
testing_ion_charges = [-1, +1]

train_neutral_df = dfs_from_geoms(training_molecules)
train_ion_df = dfs_from_geoms(training_ions, charges = training_ion_charges)
training_df = pd.concat([train_neutral_df, train_ion_df], ignore_index=True)

test_neutral_df = dfs_from_geoms(testing_molecules)
test_ion_df = dfs_from_geoms(testing_ions, charges = testing_ion_charges)
testing_df = pd.concat([test_neutral_df, test_ion_df], ignore_index= True)

stamp = datetime.now().strftime("%Y%m%d_%H%M%S")
train_parquet = f"./t1_pairs_training_{stamp}.parquet"
test_parquet = f"./t1_pairs_testing_{stamp}.parquet"

try:
    training_df.to_parquet(train_parquet, index = False)
    testing_df.to_parquet(test_parquet, index = False)
    print(f"Saved Parquet:\n {train_parquet}\n {test_parquet}")
except Exception as e:
     print(f"[warn] Parquet save failed ({e}). Install 'pyarrow' or 'fastparquet' to enable Parquet export.")